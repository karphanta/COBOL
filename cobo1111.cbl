       IDENTIFICATION DIVISION.
       PROGRAM-ID. ESTADISTICAS-AVANZADAS.

       ENVIRONMENT DIVISION.

       DATA DIVISION.

       WORKING-STORAGE SECTION.
       01  TOTAL-CLIENTES         PIC 9(5) VALUE 1200.
       01  CLIENTES-ACTIVOS       PIC 9(5) VALUE 950.
       01  CLIENTES-INACTIVOS     PIC 9(5).
       01  TOTAL-VENTAS           PIC 9(7)V99 VALUE 456789.50.
       01  PROMEDIO-VENTAS        PIC 9(5)V99.
       01  PORCENTAJE-ACTIVOS     PIC 9(3)V99.
       01  PORCENTAJE-INACTIVOS   PIC 9(3)V99.

       PROCEDURE DIVISION.
           PERFORM INICIAR-PROGRAMA THRU INICIAR-PROGRAMA-EXIT
           PERFORM CALCULAR-ESTADISTICAS THRU CALCULAR-ESTADISTICAS-EXIT
           PERFORM MOSTRAR-ESTADISTICAS THRU MOSTRAR-ESTADISTICAS-EXIT
           PERFORM FINALIZAR-PROGRAMA THRU FINALIZAR-PROGRAMA-EXIT
           STOP RUN.

       INICIAR-PROGRAMA.
           DISPLAY ">>> INICIO DE PROGRAMA DE ESTADÍSTICAS <<<".
       INICIAR-PROGRAMA-EXIT.
           EXIT.

       CALCULAR-ESTADISTICAS.
           COMPUTE CLIENTES-INACTIVOS = TOTAL-CLIENTES - CLIENTES-ACTIVOS
           IF TOTAL-CLIENTES NOT = 0
               COMPUTE PROMEDIO-VENTAS = TOTAL-VENTAS / TOTAL-CLIENTES
               COMPUTE PORCENTAJE-ACTIVOS = (CLIENTES-ACTIVOS * 100) / TOTAL-CLIENTES
               COMPUTE PORCENTAJE-INACTIVOS = (CLIENTES-INACTIVOS * 100) / TOTAL-CLIENTES
           ELSE
               DISPLAY "ERROR: TOTAL DE CLIENTES ES CERO. NO SE PUEDE CALCULAR."
           END-IF

           DISPLAY "ERROR: TOTAL DE CLIENTES ES CERO. NO SE PUEDE CALCULAR.".
       CALCULAR-ESTADISTICAS-EXIT.
           EXIT.

       MOSTRAR-ESTADISTICAS.
           DISPLAY ">>> ESTADÍSTICAS DE CLIENTES <<<".
           DISPLAY "Total de clientes: " TOTAL-CLIENTES.
           DISPLAY "Clientes activos: " CLIENTES-ACTIVOS " (" PORCENTAJE-ACTIVOS "%)".
           DISPLAY "Clientes inactivos: " CLIENTES-INACTIVOS " (" PORCENTAJE-INACTIVOS "%)".
           DISPLAY "Ventas totales: $" TOTAL-VENTAS.
           DISPLAY "Promedio por cliente: $" PROMEDIO-VENTAS.
       MOSTRAR-ESTADISTICAS-EXIT.
           EXIT.

       FINALIZAR-PROGRAMA.
           DISPLAY ">>> FIN DEL PROGRAMA <<<".
       FINALIZAR-PROGRAMA-EXIT.
           EXIT.
